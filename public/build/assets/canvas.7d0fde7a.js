document.addEventListener("DOMContentLoaded",function(){let o,I,n,S,r,d,x,p,g,c,a,v,b;x=100,p=10,g=50,c=0,a=20,v=250,S=2*Math.PI,r=[],o=document.querySelector("canvas"),E(),C(),M(),d={x:o.width/2,y:o.height/2},n=o.getContext("2d"),n||alert("\u0412\u0430\u0448 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u043D\u0435 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 canvas.");function E(){I=window.getComputedStyle(document.querySelector("canvas")).color}function C(){b=[],[".main-information-block"].forEach(i=>{const s=document.querySelector(i),h=s.getBoundingClientRect(),e=window.getComputedStyle(s),f=h.x-parseInt(e.marginLeft)-parseInt(e.paddingLeft),m=h.y-parseInt(e.marginTop)-parseInt(e.paddingTop),w=h.width+parseInt(e.marginLeft)+parseInt(e.marginRight)+parseInt(e.paddingLeft)+parseInt(e.paddingRight),l=h.height+parseInt(e.marginTop)+parseInt(e.marginBottom)+parseInt(e.paddingTop)+parseInt(e.paddingBottom);b.push({tag:i,x:f,y:m,width:w,height:l})})}function L(t){const i=I.split("(")[1].split(")")[0].split(", ");return`rgba(${i[0]}, ${i[1]}, ${i[2]}, ${t})`}function u(t,i){this.anchorX=t,this.anchorY=i,this.x=Math.random()*(t-(t-a))+(t-a),this.y=Math.random()*(i-(i-a))+(i-a),this.vx=Math.random()*2-1,this.vy=Math.random()*2-1,this.energy=Math.random()*100,this.radius=Math.random(),this.siblings=[],this.brightness=0}u.prototype.drawNode=function(){const t=L(this.brightness);n.beginPath(),n.arc(this.x,this.y,2*this.radius+2*this.siblings.length/p,0,S),n.fillStyle=t,n.fill()},u.prototype.drawConnections=function(){for(const t of this.siblings){const i=L(this.brightness);n.beginPath(),n.moveTo(this.x,this.y),n.lineTo(t.x,t.y),n.lineWidth=1-y(this,t)/x,n.strokeStyle=i,n.stroke()}},u.prototype.moveNode=function(){this.energy-=2,this.energy<1&&(this.energy=Math.random()*100,this.x-this.anchorX<-a?this.vx=Math.random()*2:this.x-this.anchorX>a?this.vx=Math.random()*-2:this.vx=Math.random()*4-2,this.y-this.anchorY<-a?this.vy=Math.random()*2:this.y-this.anchorY>a?this.vy=Math.random()*-2:this.vy=Math.random()*4-2),b.forEach(t=>{if(this.x>=t.x&&this.x<=t.x+t.width&&this.y>=t.y&&this.y<=t.y+t.height){const i=Math.abs(this.x-t.x),s=Math.abs(this.x-(t.x+t.width)),h=Math.abs(this.y-t.y),e=Math.abs(this.y-(t.y+t.height));Math.abs(i-s)<Math.abs(h-e)?this.y=h<e?t.y:t.y+t.height:this.x=i<s?t.x:t.x+t.width}}),this.x+=this.vx*this.energy/100,this.y+=this.vy*this.energy/100};function T(){if(n.clearRect(0,0,o.width,o.height),r=[],!(screen.width<480))for(let t=g;t<o.width;t+=g)for(let i=g;i<o.height;i+=g)r.push(new u(t,i)),c++}function y(t,i){return Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2))}function R(){let t,i,s;for(let h=0;h<c;h++){t=r[h],t.siblings=[];for(let e=0;e<c;e++)if(i=r[e],t!==i&&(s=y(t,i),s<x))if(t.siblings.length<p)t.siblings.push(i);else{let f=0,m=0,w;for(let l=0;l<p;l++)f=y(t,t.siblings[l]),f>m&&(m=f,w=l);s<m&&(t.siblings.splice(w,1),t.siblings.push(i))}}}function N(){M(),n.clearRect(0,0,o.width,o.height),R();let t,i,s;for(t=0;t<c;t++)i=r[t],s=y({x:d.x,y:d.y},i),s<v?i.brightness=1-s/v:i.brightness=0;for(t=0;t<c;t++)i=r[t],i.brightness&&(i.drawNode(),i.drawConnections()),i.moveNode();requestAnimationFrame(N)}function Y(){window.addEventListener("resize",H,!1),document.addEventListener("mousemove",_,!1),document.addEventListener("changeTheme",E,!1),document.addEventListener("touchmove",q,!1)}function H(){C(),M()}function M(){o.width=window.innerWidth,o.height=window.innerHeight}function _(t){d.x=t.clientX,d.y=t.clientY}function q(t){d.x=t.touches[0].clientX,d.y=t.touches[0].clientY}Y(),T(),N()});
